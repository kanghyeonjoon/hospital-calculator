<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³‘ì› ë†“ì¹œ ë§¤ì¶œ ì§„ë‹¨ ê³„ì‚°ê¸° | ìš°ë¦¬ ë³‘ì› ì†ì‹¤ ì°¾ê¸°</title>
    
    <!-- Google Fonts - Noto Sans KR -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- html2canvas -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Tailwind ì»¤ìŠ¤í…€ ì„¤ì • -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'deep-navy': '#1e293b',
                        'navy-dark': '#0f172a',
                        'warning-red': '#ef4444',
                        'warning-red-dark': '#dc2626',
                    },
                    fontFamily: {
                        'sans': ['Noto Sans KR', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    
    <style>
        /* ========================================
           ì»¤ìŠ¤í…€ CSS ìŠ¤íƒ€ì¼
        ======================================== */
        
        * {
            font-family: 'Noto Sans KR', sans-serif;
        }
        
        /* ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ */
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
            min-height: 100vh;
        }
        
        /* ë…¸ì´ì¦ˆ í…ìŠ¤ì²˜ ì˜¤ë²„ë ˆì´ */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
            opacity: 0.03;
            pointer-events: none;
            z-index: 0;
        }
        
        /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
        .main-container {
            position: relative;
            z-index: 1;
        }
        
        /* ì¹´ë“œ ê¸€ë¡œìš° íš¨ê³¼ */
        .card-glow {
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.5),
                0 0 0 1px rgba(255, 255, 255, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        /* ìŠ¬ë¼ì´ë” ì»¤ìŠ¤í…€ ìŠ¤íƒ€ì¼ */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, #334155 0%, #475569 100%);
            border-radius: 10px;
            outline: none;
            cursor: pointer;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        input[type="range"]::-webkit-slider-thumb:hover {
            transform: scale(1.15);
            box-shadow: 0 6px 20px rgba(239, 68, 68, 0.6);
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4);
        }
        
        /* ìˆ«ì ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
        input[type="number"] {
            -moz-appearance: textfield;
        }
        
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        
        /* ë²„íŠ¼ í„ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes pulse-glow {
            0%, 100% {
                box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7);
            }
            50% {
                box-shadow: 0 0 30px 10px rgba(239, 68, 68, 0.3);
            }
        }
        
        .btn-pulse {
            animation: pulse-glow 2s infinite;
        }
        
        /* ë²„íŠ¼ ë°”ìš´ìŠ¤ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes bounce-click {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(0.95);
            }
        }
        
        .btn-bounce:active {
            animation: bounce-click 0.15s ease-out;
        }
        
        /* ê²°ê³¼ ì„¹ì…˜ í˜ì´ë“œ ì¸ */
        @keyframes fade-in-up {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .fade-in-up {
            animation: fade-in-up 0.6s ease-out forwards;
        }
        
        /* ìˆ«ì ì¹´ìš´íŒ… ê¸€ë¡œìš° */
        @keyframes number-glow {
            0%, 100% {
                text-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
            }
            50% {
                text-shadow: 0 0 40px rgba(239, 68, 68, 0.8), 0 0 60px rgba(239, 68, 68, 0.4);
            }
        }
        
        .number-glow {
            animation: number-glow 1.5s ease-in-out infinite;
        }
        
        /* ì¶©ê²© ë©˜íŠ¸ í”ë“¤ë¦¼ íš¨ê³¼ */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }
        
        .shake {
            animation: shake 0.5s ease-in-out;
        }
        
        /* ê²°ê³¼ ì¹´ë“œ ë³´ë” ê·¸ë¼ë°ì´ì…˜ */
        .result-card {
            background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
            border: 1px solid transparent;
            background-clip: padding-box;
            position: relative;
        }
        
        .result-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: inherit;
            padding: 1px;
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.3), transparent, rgba(239, 68, 68, 0.1));
            -webkit-mask: 
                linear-gradient(#fff 0 0) content-box, 
                linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            pointer-events: none;
        }
        
        /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #1e293b;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        
        /* í—¤ë” í…ìŠ¤íŠ¸ ê·¸ë¼ë°ì´ì…˜ */
        .text-gradient {
            background: linear-gradient(135deg, #ffffff 0%, #94a3b8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* ê²½ê³  í…ìŠ¤íŠ¸ ê·¸ë¼ë°ì´ì…˜ */
        .text-warning-gradient {
            background: linear-gradient(135deg, #ef4444 0%, #f97316 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
    </style>
</head>

<body class="text-gray-100">
    <div class="main-container min-h-screen py-8 px-4 md:py-12">
        <div class="max-w-2xl mx-auto">
            
            <!-- ========================================
                 í—¤ë” ì„¹ì…˜
            ======================================== -->
            <header class="text-center mb-10 md:mb-14">
                <div class="inline-block mb-4">
                    <span class="text-5xl md:text-6xl">ğŸ¥</span>
                </div>
                <h1 class="text-2xl md:text-4xl font-black text-gradient mb-4 leading-tight">
                    ì˜ ë˜ëŠ” ì˜† ë³‘ì› ì›ì¥ë‹˜ì€<br>ì´ë¯¸ í™•ì¸í•˜ê³  ê°”ìŠµë‹ˆë‹¤.
                </h1>
                <p class="text-gray-400 text-base md:text-lg font-light">
                    ë…¸ì‡¼, ì¬ë°©ë¬¸ ì´íƒˆ... ë§¤ë‹¬ ì–¼ë§ˆë‚˜ ìƒˆëŠ”ì§€ <span class="text-warning-red font-bold">1ë¶„</span>ì´ë©´ ë‚˜ì˜µë‹ˆë‹¤.
                </p>
            </header>
            
            <!-- ========================================
                 ì…ë ¥ ì„¹ì…˜ (Input Card)
            ======================================== -->
            <section class="bg-white/[0.03] backdrop-blur-xl rounded-3xl p-6 md:p-10 card-glow mb-8">
                <h2 class="text-lg md:text-xl font-bold text-white mb-8 flex items-center gap-3">
                    <i class="fa-solid fa-calculator text-warning-red"></i>
                    ìš°ë¦¬ ë³‘ì› ì •ë³´ ì…ë ¥
                </h2>
                
                <form id="calculator-form" class="space-y-8">
                    
                    <!-- ì…ë ¥ 1: ì¼ í‰ê·  ë‚´ì› í™˜ì ìˆ˜ -->
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fa-solid fa-users text-blue-400 mr-2"></i>
                            ì¼ í‰ê·  ë‚´ì› í™˜ì ìˆ˜
                        </label>
                        <div class="flex items-center gap-4">
                            <input 
                                type="number" 
                                id="patients" 
                                min="1" 
                                max="500" 
                                value="30"
                                class="w-24 md:w-28 px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-xl text-white text-center text-lg font-bold focus:outline-none focus:ring-2 focus:ring-warning-red focus:border-transparent transition-all"
                            >
                            <span class="text-gray-400 font-medium">ëª…</span>
                            <input 
                                type="range" 
                                id="patients-slider" 
                                min="1" 
                                max="200" 
                                value="30"
                                class="flex-1"
                            >
                        </div>
                    </div>
                    
                    <!-- ì…ë ¥ 2: í™˜ì 1ì¸ë‹¹ í‰ê·  ê°ë‹¨ê°€ -->
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fa-solid fa-won-sign text-green-400 mr-2"></i>
                            í™˜ì 1ì¸ë‹¹ í‰ê·  ê°ë‹¨ê°€
                        </label>
                        <div class="flex items-center gap-4">
                            <input 
                                type="number" 
                                id="price" 
                                min="10000" 
                                max="5000000" 
                                step="10000"
                                value="150000"
                                class="w-32 md:w-36 px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-xl text-white text-center text-lg font-bold focus:outline-none focus:ring-2 focus:ring-warning-red focus:border-transparent transition-all"
                            >
                            <span class="text-gray-400 font-medium">ì›</span>
                            <input 
                                type="range" 
                                id="price-slider" 
                                min="10000" 
                                max="1000000" 
                                step="10000"
                                value="150000"
                                class="flex-1"
                            >
                        </div>
                        <p class="text-xs text-gray-500 mt-2">
                            ğŸ’¡ ì§„ë£Œë¹„, ì‹œìˆ ë¹„, ì²˜ë°©ë£Œ ë“± í‰ê·  ê²°ì œ ê¸ˆì•¡
                        </p>
                    </div>
                    
                    <!-- ì…ë ¥ 3: ì˜ˆì•½ ë¶€ë„ìœ¨ (ë…¸ì‡¼) -->
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fa-solid fa-user-slash text-warning-red mr-2"></i>
                            ì˜ˆì•½ ë¶€ë„ìœ¨ (ë…¸ì‡¼)
                        </label>
                        <div class="flex items-center gap-4">
                            <input 
                                type="number" 
                                id="noshow" 
                                min="0" 
                                max="50" 
                                value="10"
                                class="w-20 md:w-24 px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-xl text-white text-center text-lg font-bold focus:outline-none focus:ring-2 focus:ring-warning-red focus:border-transparent transition-all"
                            >
                            <span class="text-gray-400 font-medium">%</span>
                            <input 
                                type="range" 
                                id="noshow-slider" 
                                min="0" 
                                max="50" 
                                value="10"
                                class="flex-1"
                            >
                        </div>
                        <p class="text-xs text-gray-500 mt-2">
                            âš ï¸ ì—…ê³„ í‰ê· : 10~15%
                        </p>
                    </div>
                    
                    <!-- ì…ë ¥ 4: ì¬ë°©ë¬¸ ë¯¸ë°©ë¬¸ í™˜ì ìˆ˜ -->
                    <div class="input-group">
                        <label class="block text-sm font-medium text-gray-300 mb-3">
                            <i class="fa-solid fa-door-open text-orange-400 mr-2"></i>
                            ì¬ë°©ë¬¸ ê¶Œìœ  í›„ ì•ˆ ì˜¤ëŠ” í™˜ì ìˆ˜ <span class="text-gray-500 font-normal">(ì›” ê¸°ì¤€)</span>
                        </label>
                        <div class="flex items-center gap-4">
                            <input 
                                type="number" 
                                id="churn" 
                                min="0" 
                                max="500" 
                                value="20"
                                class="w-24 md:w-28 px-4 py-3 bg-slate-800/50 border border-slate-600 rounded-xl text-white text-center text-lg font-bold focus:outline-none focus:ring-2 focus:ring-warning-red focus:border-transparent transition-all"
                            >
                            <span class="text-gray-400 font-medium">ëª…</span>
                            <input 
                                type="range" 
                                id="churn-slider" 
                                min="0" 
                                max="200" 
                                value="20"
                                class="flex-1"
                            >
                        </div>
                        <p class="text-xs text-gray-500 mt-2">
                            ğŸ’¡ "ë‹¤ìŒì— ì˜¤ì„¸ìš”" í–ˆëŠ”ë° ì•ˆ ì˜¨ í™˜ì, ëŒ€ëµ ëª‡ ëª…ì¯¤ ë˜ì‹œë‚˜ìš”?
                        </p>
                    </div>
                    
                    <!-- ì§„ë‹¨ ë²„íŠ¼ -->
                    <button 
                        type="submit" 
                        id="calculate-btn"
                        class="w-full py-5 bg-gradient-to-r from-warning-red to-warning-red-dark text-white text-lg md:text-xl font-black rounded-2xl btn-pulse btn-bounce hover:from-warning-red-dark hover:to-red-700 transition-all duration-300 flex items-center justify-center gap-3 mt-10"
                    >
                        <i class="fa-solid fa-magnifying-glass-dollar text-xl"></i>
                        ë‚´ ë³‘ì› ì†ì‹¤ì•¡ ì§„ë‹¨í•˜ê¸°
                    </button>
                </form>
            </section>
            
            <!-- ========================================
                 ê²°ê³¼ ì„¹ì…˜ (Result Section)
            ======================================== -->
            <section id="result-section" class="hidden">
                
                <!-- ê²°ê³¼ ì¹´ë“œ (ìº¡ì²˜ ì˜ì—­) -->
                <div id="result-capture" class="result-card rounded-3xl p-6 md:p-10 mb-6">
                    
                    <!-- ê²°ê³¼ í—¤ë” -->
                    <div class="text-center mb-8">
                        <p class="text-gray-400 text-sm md:text-base mb-2">
                            ì§€ë‚œë‹¬, ì›ì¥ë‹˜ì´ ë†“ì¹œ ë§¤ì¶œì€...
                        </p>
                        <div class="w-16 h-1 bg-gradient-to-r from-warning-red to-orange-500 mx-auto rounded-full"></div>
                    </div>
                    
                    <!-- ì›”ê°„ ì†ì‹¤ì•¡ -->
                    <div class="text-center mb-8">
                        <p class="text-gray-400 text-xs mb-2 uppercase tracking-wider">Monthly Loss</p>
                        <div class="flex items-baseline justify-center gap-2">
                            <span id="monthly-loss" class="text-4xl md:text-6xl font-black text-warning-red number-glow">
                                0
                            </span>
                            <span class="text-xl md:text-2xl text-warning-red font-bold">ì›</span>
                        </div>
                    </div>
                    
                    <!-- ì—°ê°„ ì†ì‹¤ì•¡ -->
                    <div class="text-center mb-8 pb-8 border-b border-slate-700/50">
                        <p class="text-gray-500 text-xs mb-1 uppercase tracking-wider">Yearly Loss</p>
                        <div class="flex items-baseline justify-center gap-2">
                            <span id="yearly-loss" class="text-2xl md:text-3xl font-bold text-gray-400">
                                0
                            </span>
                            <span class="text-base md:text-lg text-gray-500 font-medium">ì›</span>
                        </div>
                    </div>
                    
                    <!-- ì†ì‹¤ ì„¸ë¶€ ë‚´ì—­ -->
                    <div class="grid grid-cols-2 gap-4 mb-8">
                        <div class="bg-slate-800/30 rounded-xl p-4 text-center">
                            <i class="fa-solid fa-user-slash text-warning-red text-xl mb-2"></i>
                            <p class="text-xs text-gray-500 mb-1">ë…¸ì‡¼ ì†ì‹¤</p>
                            <p id="noshow-loss" class="text-lg font-bold text-white">0ì›</p>
                        </div>
                        <div class="bg-slate-800/30 rounded-xl p-4 text-center">
                            <i class="fa-solid fa-door-open text-orange-400 text-xl mb-2"></i>
                            <p class="text-xs text-gray-500 mb-1">ì´íƒˆ ì†ì‹¤</p>
                            <p id="churn-loss" class="text-lg font-bold text-white">0ì›</p>
                        </div>
                    </div>
                    
                    <!-- ì¶©ê²© ë©˜íŠ¸ -->
                    <div id="shock-message" class="bg-gradient-to-r from-warning-red/10 to-orange-500/10 border border-warning-red/30 rounded-2xl p-5 md:p-6">
                        <div class="flex items-start gap-3">
                            <i class="fa-solid fa-triangle-exclamation text-warning-red text-xl mt-1 flex-shrink-0"></i>
                            <p id="shock-text" class="text-sm md:text-base text-gray-200 font-medium leading-relaxed">
                                <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ -->
                            </p>
                        </div>
                    </div>
                    
                    <!-- ì›Œí„°ë§ˆí¬ -->
                    <div class="text-center mt-8 pt-6 border-t border-slate-700/30">
                        <p class="text-xs text-gray-600">
                            ğŸ¥ Hospital Branding System
                        </p>
                    </div>
                </div>
                
                <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
                <div class="space-y-4">
                    
                    <!-- ì´ë¯¸ì§€ ì €ì¥ ë²„íŠ¼ -->
                    <button 
                        id="save-image-btn"
                        class="w-full py-4 bg-slate-700/50 hover:bg-slate-600/50 text-white text-base font-bold rounded-xl transition-all duration-300 flex items-center justify-center gap-3 border border-slate-600"
                    >
                        <i class="fa-solid fa-camera text-lg"></i>
                        ê²°ê³¼í‘œ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸° ğŸ“¸
                    </button>
                    
                    <!-- ìƒë‹´ í˜œíƒ ì„¤ëª… -->
                <div class="bg-slate-800/30 rounded-xl p-4 mb-4 text-center">
                    <p class="text-sm text-gray-300 leading-relaxed">
                        <span class="text-green-400">âœ“</span> ë…¸ì‡¼ ì•Œë¦¼ ìë™í™”, ì¬ë°©ë¬¸ ìœ ë„ ë¬¸ì ì„¸íŒ…<br>
                        <span class="text-white font-medium">ìš°ë¦¬ ë³‘ì›ì— ë§ëŠ” í•´ê²°ì±…ì„ ë¬´ë£Œë¡œ ì§„ë‹¨í•´ë“œë¦½ë‹ˆë‹¤.</span>
                    </p>
                </div>
                
                <!-- CTA ë²„íŠ¼ -->
                    <a 
                        href="https://open.kakao.com/me/Moneymedic_ops"
                        target="_blank"
                        id="cta-btn"
                        class="block w-full py-5 bg-gradient-to-r from-yellow-400 to-yellow-500 hover:from-yellow-500 hover:to-yellow-600 text-black text-lg font-black rounded-xl transition-all duration-300 text-center"
                    >
                        <i class="fa-solid fa-comment mr-2"></i>ì¹´ì¹´ì˜¤í†¡ìœ¼ë¡œ ë¬´ë£Œ ìƒë‹´ë°›ê¸°
                    </a>
                    
                    <!-- ë‹¤ì‹œ ê³„ì‚°í•˜ê¸° -->
                    <button 
                        id="recalculate-btn"
                        class="w-full py-3 text-gray-400 hover:text-white text-sm font-medium transition-colors"
                    >
                        <i class="fa-solid fa-rotate-left mr-2"></i>
                        ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°
                    </button>
                </div>
            </section>
            
            <!-- ========================================
                 í‘¸í„°
            ======================================== -->
            <footer class="text-center mt-16 pt-8 border-t border-slate-700/30">
                <p class="text-xs text-gray-600">
                    Copyright Â© Hospital Branding System. All rights reserved.
                </p>
            </footer>
        </div>
    </div>

    <!-- ========================================
         JavaScript
    ======================================== -->
    <script>
        // ========================================
        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
        // ========================================
        
        /**
         * ìˆ«ìì— 3ìë¦¬ë§ˆë‹¤ ì½¤ë§ˆë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
         * @param {number} num - ë³€í™˜í•  ìˆ«ì
         * @returns {string} ì½¤ë§ˆê°€ ì¶”ê°€ëœ ë¬¸ìì—´
         */
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        /**
         * ì¹´ìš´íŒ… ì• ë‹ˆë©”ì´ì…˜ í•¨ìˆ˜
         * @param {HTMLElement} element - ì• ë‹ˆë©”ì´ì…˜ì„ ì ìš©í•  ìš”ì†Œ
         * @param {number} target - ëª©í‘œ ìˆ«ì
         * @param {number} duration - ì• ë‹ˆë©”ì´ì…˜ ì§€ì† ì‹œê°„ (ms)
         */
        function animateCount(element, target, duration = 1500) {
            const start = 0;
            const startTime = performance.now();
            
            function update(currentTime) {
                const elapsed = currentTime - startTime;
                const progress = Math.min(elapsed / duration, 1);
                
                // easeOutExpo ì´ì§• í•¨ìˆ˜
                const easeProgress = 1 - Math.pow(1 - progress, 4);
                const current = Math.floor(start + (target - start) * easeProgress);
                
                element.textContent = formatNumber(current);
                
                if (progress < 1) {
                    requestAnimationFrame(update);
                }
            }
            
            requestAnimationFrame(update);
        }
        
        /**
         * ì†ì‹¤ì•¡ì— ë”°ë¥¸ ì¶©ê²© ë©˜íŠ¸ ìƒì„± í•¨ìˆ˜
         * @param {number} monthlyLoss - ì›”ê°„ ì†ì‹¤ì•¡
         * @returns {string} ì¶©ê²© ë©˜íŠ¸
         */
        function getShockMessage(monthlyLoss) {
            switch (true) {
                case monthlyLoss < 1000000:
                    return "ìµœì‹ í˜• ì•ˆë§ˆì˜ì ë Œíƒˆë¹„ë¥¼ ë§¤ë‹¬ ë‚ ë¦¬ê³  ê³„ì‹œë„¤ìš”. ì‘ì€ ê¸ˆì•¡ì´ë¼ ìƒê°í•˜ì‹¤ ìˆ˜ ìˆì§€ë§Œ, 1ë…„ì´ë©´ ì²œë§Œ ì›ì´ í›Œì© ë„˜ìŠµë‹ˆë‹¤.";
                
                case monthlyLoss >= 1000000 && monthlyLoss < 3000000:
                    return "ë§¤ë‹¬ ê°€ì¡±ë“¤ê³¼ ë– ë‚  ìˆ˜ ìˆëŠ” í•´ì™¸ì—¬í–‰ ê¸°íšŒë¥¼ ë²„ë¦¬ê³  ê³„ì‹­ë‹ˆë‹¤. ì´ ëˆì´ë©´ ë§¤ë…„ ë‘ ë²ˆì˜ ê°€ì¡±ì—¬í–‰ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.";
                
                case monthlyLoss >= 3000000 && monthlyLoss < 5000000:
                    return "ëŠ¥ë ¥ ìˆëŠ” ë§ˆì¼€íŒ… ì§ì› 1ëª…ì˜ ì›”ê¸‰ì„ ê¸¸ë°”ë‹¥ì— ë²„ë¦¬ê³  ê³„ì‹­ë‹ˆë‹¤. ê·¸ ì§ì›ì´ ê°€ì ¸ì˜¬ ì¶”ê°€ ë§¤ì¶œì€ ìƒê°í•´ë³´ì…¨ë‚˜ìš”?";
                
                case monthlyLoss >= 5000000 && monthlyLoss < 10000000:
                    return "ê²½ì°¨ í•œ ëŒ€ ê°’ì„ ë§¤ë‹¬ íƒœì›Œë²„ë¦¬ëŠ” ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤. ì—°ê°„ìœ¼ë¡œ í™˜ì‚°í•˜ë©´ ì¤‘í˜• ì„¸ë‹¨ ìˆ˜ì¤€ì˜ ì†ì‹¤ì…ë‹ˆë‹¤.";
                
                case monthlyLoss >= 10000000:
                    return "ë§¤ë‹¬ ì§ì› 2ëª… ì´ìƒì˜ ì›”ê¸‰ì´ ê·¸ëƒ¥ ì¦ë°œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ ë¹„ìš©ì´ë©´ ë³‘ì› ì‹œìŠ¤í…œì„ ì™„ì „íˆ ìƒˆë¡œ ì„¸íŒ…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
                
                default:
                    return "ì‘ì€ êµ¬ë©ì´ í° ë°°ë¥¼ ì¹¨ëª°ì‹œí‚µë‹ˆë‹¤. ì§€ê¸ˆ ë°”ë¡œ í–‰ë™í•˜ì„¸ìš”.";
            }
        }
        
        // ========================================
        // DOM ìš”ì†Œ ì°¸ì¡°
        // ========================================
        const form = document.getElementById('calculator-form');
        const resultSection = document.getElementById('result-section');
        const monthlyLossEl = document.getElementById('monthly-loss');
        const yearlyLossEl = document.getElementById('yearly-loss');
        const noshowLossEl = document.getElementById('noshow-loss');
        const churnLossEl = document.getElementById('churn-loss');
        const shockTextEl = document.getElementById('shock-text');
        const shockMessageEl = document.getElementById('shock-message');
        const saveImageBtn = document.getElementById('save-image-btn');
        const recalculateBtn = document.getElementById('recalculate-btn');
        
        // ì…ë ¥ í•„ë“œì™€ ìŠ¬ë¼ì´ë”
        const inputs = {
            patients: document.getElementById('patients'),
            patientsSlider: document.getElementById('patients-slider'),
            price: document.getElementById('price'),
            priceSlider: document.getElementById('price-slider'),
            noshow: document.getElementById('noshow'),
            noshowSlider: document.getElementById('noshow-slider'),
            churn: document.getElementById('churn'),
            churnSlider: document.getElementById('churn-slider')
        };
        
        // ========================================
        // ìŠ¬ë¼ì´ë”ì™€ ì…ë ¥ í•„ë“œ ë™ê¸°í™”
        // ========================================
        
        // í™˜ì ìˆ˜ ë™ê¸°í™”
        inputs.patients.addEventListener('input', () => {
            inputs.patientsSlider.value = inputs.patients.value;
        });
        inputs.patientsSlider.addEventListener('input', () => {
            inputs.patients.value = inputs.patientsSlider.value;
        });
        
        // ê°ë‹¨ê°€ ë™ê¸°í™”
        inputs.price.addEventListener('input', () => {
            inputs.priceSlider.value = inputs.price.value;
        });
        inputs.priceSlider.addEventListener('input', () => {
            inputs.price.value = inputs.priceSlider.value;
        });
        
        // ë…¸ì‡¼ìœ¨ ë™ê¸°í™”
        inputs.noshow.addEventListener('input', () => {
            inputs.noshowSlider.value = inputs.noshow.value;
        });
        inputs.noshowSlider.addEventListener('input', () => {
            inputs.noshow.value = inputs.noshowSlider.value;
        });
        
        // ì´íƒˆë¥  ë™ê¸°í™”
        inputs.churn.addEventListener('input', () => {
            inputs.churnSlider.value = inputs.churn.value;
        });
        inputs.churnSlider.addEventListener('input', () => {
            inputs.churn.value = inputs.churnSlider.value;
        });
        
        // ========================================
        // ê³„ì‚° ë¡œì§
        // ========================================
        form.addEventListener('submit', (e) => {
            e.preventDefault();
            
            // ì…ë ¥ê°’ ê°€ì ¸ì˜¤ê¸°
            const patients = parseInt(inputs.patients.value) || 0;
            const price = parseInt(inputs.price.value) || 0;
            const noshowRate = parseFloat(inputs.noshow.value) / 100 || 0;
            const churnPatients = parseInt(inputs.churn.value) || 0; // ì›” ê¸°ì¤€ ë¯¸ë°©ë¬¸ í™˜ì ìˆ˜
            
            // ì›” ì˜ì—…ì¼ (í‰ê·  25ì¼)
            const workDays = 25;
            
            // ì›” ì´ ì˜ˆìƒ í™˜ì ìˆ˜
            const monthlyPatients = patients * workDays;
            
            // ë…¸ì‡¼ ì†ì‹¤ ê³„ì‚° (ë…¸ì‡¼ í™˜ì ìˆ˜ Ã— ê°ë‹¨ê°€)
            const noshowLoss = Math.round(monthlyPatients * noshowRate * price);
            
            // ì´íƒˆ ì†ì‹¤ ê³„ì‚° (ë¯¸ë°©ë¬¸ í™˜ì ìˆ˜ Ã— ê°ë‹¨ê°€) - ì´ì œ ì§ì ‘ ëª…ìˆ˜ë¡œ ê³„ì‚°
            const churnLoss = Math.round(churnPatients * price);
            
            // ì´ ì›”ê°„ ì†ì‹¤
            const monthlyLoss = noshowLoss + churnLoss;
            
            // ì—°ê°„ ì†ì‹¤
            const yearlyLoss = monthlyLoss * 12;
            
            // ê²°ê³¼ ì„¹ì…˜ í‘œì‹œ
            resultSection.classList.remove('hidden');
            resultSection.classList.add('fade-in-up');
            
            // ê²°ê³¼ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            setTimeout(() => {
                resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
            
            // ì¹´ìš´íŒ… ì• ë‹ˆë©”ì´ì…˜ ì ìš©
            animateCount(monthlyLossEl, monthlyLoss, 1500);
            animateCount(yearlyLossEl, yearlyLoss, 2000);
            
            // ì„¸ë¶€ ì†ì‹¤ì•¡ í‘œì‹œ (ë”œë ˆì´ í›„)
            setTimeout(() => {
                noshowLossEl.textContent = formatNumber(noshowLoss) + 'ì›';
                churnLossEl.textContent = formatNumber(churnLoss) + 'ì›';
            }, 800);
            
            // ì¶©ê²© ë©˜íŠ¸ í‘œì‹œ
            setTimeout(() => {
                shockTextEl.textContent = getShockMessage(monthlyLoss);
                shockMessageEl.classList.add('shake');
                setTimeout(() => {
                    shockMessageEl.classList.remove('shake');
                }, 500);
            }, 1600);
        });
        
        // ========================================
        // ì´ë¯¸ì§€ ì €ì¥ ê¸°ëŠ¥
        // ========================================
        saveImageBtn.addEventListener('click', async () => {
            const captureEl = document.getElementById('result-capture');
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            saveImageBtn.disabled = true;
            saveImageBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin mr-2"></i>ì´ë¯¸ì§€ ìƒì„± ì¤‘...';
            
            try {
                // html2canvasë¡œ ìº¡ì²˜
                const canvas = await html2canvas(captureEl, {
                    backgroundColor: '#0f172a',
                    scale: 2, // ê³ í•´ìƒë„
                    useCORS: true,
                    logging: false
                });
                
                // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
                const link = document.createElement('a');
                link.download = `ë³‘ì›ë§¤ì¶œëˆ„ìˆ˜ì§„ë‹¨_${new Date().toISOString().slice(0,10)}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
                
                // ì„±ê³µ ë©”ì‹œì§€
                saveImageBtn.innerHTML = '<i class="fa-solid fa-check mr-2"></i>ì €ì¥ ì™„ë£Œ!';
                setTimeout(() => {
                    saveImageBtn.innerHTML = '<i class="fa-solid fa-camera text-lg"></i> ê²°ê³¼í‘œ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸° ğŸ“¸';
                    saveImageBtn.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('ì´ë¯¸ì§€ ì €ì¥ ì‹¤íŒ¨:', error);
                saveImageBtn.innerHTML = '<i class="fa-solid fa-xmark mr-2"></i>ì €ì¥ ì‹¤íŒ¨';
                setTimeout(() => {
                    saveImageBtn.innerHTML = '<i class="fa-solid fa-camera text-lg"></i> ê²°ê³¼í‘œ ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸° ğŸ“¸';
                    saveImageBtn.disabled = false;
                }, 2000);
            }
        });
        
        // ========================================
        // ë‹¤ì‹œ ê³„ì‚°í•˜ê¸°
        // ========================================
        recalculateBtn.addEventListener('click', () => {
            // ê²°ê³¼ ì„¹ì…˜ ìˆ¨ê¹€
            resultSection.classList.add('hidden');
            resultSection.classList.remove('fade-in-up');
            
            // ì…ë ¥ ì„¹ì…˜ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.querySelector('header').scrollIntoView({ behavior: 'smooth', block: 'start' });
        });
        
        // ========================================
        // ì´ˆê¸°í™” ì‹œ ìŠ¬ë¼ì´ë” ë™ê¸°í™”
        // ========================================
        window.addEventListener('DOMContentLoaded', () => {
            // ìŠ¬ë¼ì´ë” ì´ˆê¸°ê°’ ë™ê¸°í™”
            inputs.patientsSlider.value = inputs.patients.value;
            inputs.priceSlider.value = inputs.price.value;
            inputs.noshowSlider.value = inputs.noshow.value;
            inputs.churnSlider.value = inputs.churn.value;
        });
    </script>
</body>
</html>